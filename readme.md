Neural Population Decoding and Imbalanced Multi-Omic Datasets for Cancer Subtype Diagnosis
============================   
This is the code repository for the paper *Neural Population Decoding and Imbalanced Multi-Omic Datasets for Cancer Subtype Diagnosis*.


## Running the Code
### 1)  `preprocessing.py`
First, we run this script to merge the omics data from the TCGA dataset into a single CSV file per cancer subtype, named `multi_omic.csv`.

    .
    ├── ...                     # Repository root level
    ├── preprocessing.py        
    ├── run_hierarchical.py
    ├── TCGA_data               # Multi-omic dataset from TCGA
    │     ├── BRCA                  # Cancer subtypes
    |     |    ├── multi_omic.csv   # Will be generated by preprocessing.py
    |     |    ├── label.csv        # CSV containing patient IDs + target variable
    |     |    └── data             # Omics data for each patient
    |     |          ├── gene.csv
    |     |          ├── methyl.csv
    |     |          └── miRNA.csv
    |     |          
    │     ├── KIRC              # Same directory structure for each cancer subtype       
    │     └── ...                
    └── ...


### 2)  `self_organising_map.py`
Secondly, we use the multi-omic patient data from `multi_omic.csv` to generate a self-organising map using Kohonen's algorithm. Each patient in the dataset will then have a gene similarity network generated as a PNG image file. Also recorded are the corresponding target variables, and a binary indicator of whether each patient is from the original dataset or added via oversampling.

    .
    ├── ...                     # Repository root level
    ├── self_organising_map.py        
    ├── patient_som_data        # Output folder created by self_organising_map.py
    │     ├── BRCA                  # Cancer subtypes
    |     |    ├── patient_0.png    # PNG image for each patient GSN
    |     |    ├── patient_1.png    
    |     |    ├── ...  
    |     |    ├── original.npy     # Tracks SMOTE vs original data
    |     |    ├── target.npy       # Target variable / labels
    |     |    └── SOM_data.npy     # GSNs for all patients
    |     |          
    │     ├── KIRC              # Same directory structure for each cancer subtype       
    │     └── ...                
    └── ...



### 3)  `run_hierarchical.py`

Here we run the training and testing loops for the hierarchical bayesian WTA network. The GSN images are converted into spike trains under the folder `data\spikes`. The nework is trained on the training set

    .
    ├── ...                     # Repository root level
    ├── run_hierarchical.py        
    ├── data        # Output folder created by run_hierarchical.py
    │     └── spikes                  
    |          ├── BRCA    # Cancer subtypes
    |          |    ├── X_spikes_0.pkl    # Spike trains
    |          |    └── X_spikes_10.pkl                    
    |          └── ...  
    |
    ├── results         
    |       └── BRCA    # Cancer subtypes     
    |          |    ├── X_spikes_0.pkl    # Results output files
    |          |    ├── X_spikes_0.pkl    
    |          |    ├── X_spikes_0.pkl    
    |          |    └── X_spikes_10.pkl                    
    |          └── ...                    
    └── ...


## 4) `population_decoding.py`


## References

The data used in `TCGA_data` was sourced from The Cancer Genome Atlas, provided by National Cancer Institute. Datasets are available at https://www.cancer.gov/tcga. Unfortunately, due to file size limitations of GitHub repositories, we are unable to supply complete examples within this resource.

The code for the Hierarchical Bayesian Network via Spiking Neural Network was originally forked from the implementation by Otto van der Himst for the paper *Bayesian Integration of Information Using Top-Down Modulated WTA Networks*, available at https://github.com/Grottoh/WTA-Network

The implementation of self-organising maps and gene similiary networks in `self_organising_map.py` was originally forked from [iSOM-GSN](https://github.com/NaziaFatima/iSOM_GSN), although numerous alterations have been made in order to produce binarized GSN images rather than RGB. See Section 3 of the research paper for details.

